<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Roblox FFlag Tracker</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      background: linear-gradient(135deg,#4f46e5,#3b82f6,#06b6d4,#14b8a6);
      background-size: 400% 400%;
      animation: gradientBG 15s ease infinite;
      color: #fff;
    }
    @keyframes gradientBG {
      0% {background-position:0% 50%;}
      50% {background-position:100% 50%;}
      100% {background-position:0% 50%;}
    }
    header {
      text-align:center;
      padding:60px 20px;
      text-shadow:0 0 12px rgba(0,0,0,0.3);
    }
    header h1 { font-size:3rem; font-weight:700; }
    .stats {
      display:flex;
      justify-content:center;
      gap:30px;
      flex-wrap:wrap;
      max-width:900px;
      margin:-40px auto 40px;
      position:relative; z-index:2;
    }
    .badge {
      flex:1; min-width:220px;
      text-align:center;
      padding:25px;
      border-radius:16px;
      font-weight:700;
      backdrop-filter:blur(10px);
      background:rgba(255,255,255,0.15);
      box-shadow:0 10px 30px rgba(0,0,0,0.3);
      transition: transform 0.3s ease, box-shadow 0.3s ease, border 0.3s ease;
    }
    .badge:hover {
      transform:translateY(-8px);
      box-shadow:0 14px 40px rgba(0,0,0,0.4);
      border:2px solid #34d399;
    }
    .added { border-left:6px solid #34d399; }
    .removed { border-left:6px solid #f87171; }
    .last-run { text-align:center; margin:20px 0; font-style:italic; color:#eee; }
    section {
      max-width:1200px; margin:0 auto; padding:20px;
    }
    .report-container {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      border-radius:16px;
      box-shadow:0 12px 36px rgba(0,0,0,0.25);
      padding:15px;
    }
    iframe { width:100%; height:75vh; border:none; border-radius:12px; }
    canvas#trendChart { display:block; max-width:850px; margin:40px auto; border-radius:12px; }
    input#searchInput {
      width:90%; padding:12px; margin:20px auto; display:block;
      border-radius:12px; border:1px solid rgba(255,255,255,0.3);
      background:rgba(0,0,0,0.2); color:#fff; font-size:1rem;
      backdrop-filter:blur(5px);
    }
    footer { text-align:center; margin-top:60px; padding:25px; font-size:0.9rem; color:#eee; }
  </style>
</head>
<body>
  <header>
    <h1>Roblox Client FFlag Tracker</h1>
  </header>
  
  <section>
    <div class="stats">
      <div class="badge added">‚úÖ Added: <span id="flags-added">30</span></div>
      <div class="badge removed">‚ùå Removed: <span id="flags-removed">15</span></div>
    </div>
    <p class="last-run">Last Run: <span id="last-run">2025-09-22 10:00:00</span></p>
    <input type="text" id="searchInput" placeholder="Search flags...">
  
    <h2>üìä Category-wise FFlag Summary</h2>
    <ul id="category-list">
      <li><strong>category1:</strong> Added: 10, Removed: 5, Total: 15</li>
      <li><strong>category2:</strong> Added: 20, Removed: 10, Total: 30</li>
    </ul>
  
    <h2>üìä Latest Full Report</h2>
    <div class="report-container">
      <iframe src="FFlag_Report.html" id="reportFrame"></iframe>
    </div>
  
    <canvas id="trendChart"></canvas>
  </section>
  
  <footer>Built with ‚ù§Ô∏è by FFlag Tracker ‚Ä¢ Updated automatically</footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Adding Category-wise Summary dynamically
    fetch("FFlag_Report.json").then(response => response.json()).then(data => {
      const categoryList = document.getElementById("category-list");
      const summary = data.summary;

      // Loop through the summary object and create list items for each category
      for (let category in summary) {
        const added = summary[category].added;
        const removed = summary[category].removed;
        const total = added + removed;

        // Create a list item for each category and append it to the category list
        const listItem = document.createElement("li");
        listItem.innerHTML = `<strong>${category}:</strong> Added: ${added}, Removed: ${removed}, Total: ${total}`;
        categoryList.appendChild(listItem);
      }

      // Optionally: Update other fields like total flags added/removed and last run time
      document.getElementById('flags-added').innerText = data.added_total;
      document.getElementById('flags-removed').innerText = data.removed_total;
      document.getElementById('last-run').innerText = data.last_run;
    });

    // Existing trend chart population logic using the history.json data
    fetch("history.json").then(r => r.json()).then(data => {
      const ctx = document.getElementById("trendChart").getContext("2d");
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: data.map(d => d.date), // Map dates for the x-axis
          datasets: [
            {
              label: 'Added',
              data: data.map(d => d.added), // Map added counts for the y-axis
              borderColor: '#34d399',
              backgroundColor: 'rgba(52,211,153,0.2)',
              fill: true,
              tension: 0.4
            },
            {
              label: 'Removed',
              data: data.map(d => d.removed), // Map removed counts for the y-axis
              borderColor: '#f87171',
              backgroundColor: 'rgba(248,113,113,0.2)',
              fill: true,
              tension: 0.4
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'top' } // Position the legend at the top
          },
          interaction: {
            mode: 'nearest',
            axis: 'x',
            intersect: false
          }
        }
      });
    });

    // Implementing search functionality for filtering flags within the iframe report
    document.getElementById('searchInput').addEventListener('input', function () {
      const q = this.value.toLowerCase(); // Convert search query to lowercase
      const iframe = document.getElementById('reportFrame');
      const doc = iframe.contentDocument || iframe.contentWindow.document;

      // Filter the list of flags in the iframe based on the search query
      doc.querySelectorAll('li').forEach(li => {
        li.style.display = li.textContent.toLowerCase().includes(q) ? '' : 'none';
      });
    });
  </script>
</body>
</html>
